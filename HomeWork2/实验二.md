# 实验二 --实现朴素贝叶斯分类器

实验二要求使用朴素贝叶斯方法对数据集20-news-18828进行分类

## 数据分类和统计
首先将数据集分成为训练集 trainset 和测试集 testset,
在每一个类中按照4:1的比例将文档分为训练集和测试集
使用字典存储 trainset 和testset 
trainset的结构如下:

|类名|该类下的文档|
|---|-----------|
|类一|训练文档一,....|
|类二|训练文档二,...|

testset的结构如下
|类名|该类下的文档|
|----|-----------|
|类一|测试文档一,....|
|类二|测试文档二,....|

在训练的时候,首先对文档建立词袋模型,然后统计训练集中每一类下的出现的所有单词和每一个单词出现的次数,重复出现的单词多次计数,(多项式模型),这样就得到了每一个类中含有多少的单词和单词的出现次数,同样可以得到每一类下的单词总数

在使用测试集做测试的时候,对测试集文档进行相同的处理,统计测试集文档中单词的出现的次数.

## 使用朴素贝叶斯进行计算
假设我们共有c类个文档,对于测试集中的每一篇文档t,计算当文档中的某一个单词
$t_k$
出现时该文档属于某一类文档的概率.
$$\begin{matrix}
    p(c|t_k)=\frac{c文档下单词t出现的次数}{c文档下的所有单词数}
\end{matrix} $$
则该文档出现在某一类下的概率可以表示为上述概率的和

$p(c|t)=p(c)\prod_{t_k \in t} p(c|t_k)$

在利用上式进行计算的时候,如果其中的某一个单词$t_k$在文档c中没有出现,则计算出来的$p(c|t)$结果为0,所以在实际的计算过程中,使用
$$\begin{matrix}
    p(c|t_k)=\frac{c类下单词t出现的次数+1}{c类下的所有单词数+c类的词项数}
\end{matrix}
$$

通过比较,选择概率最大的那一类作为文档t的所属类别.

## 结果分析
首先对于所有的文档.进行了以下三种测试

1.在每一类中划分出$
\frac{1}{10}$作为测试集,剩余文档作为训练集,

2.在每一类下划分出$\frac{1}{5}$作为测试集,剩余文档作为训练集

3.前面两项测试均为均匀分类,即每一类下的训练集和测试集的比例相同,第三个测试中,使用随机划分的训练集和测试集重新计算.

以上三种测试得到的结果比较如下

|分类|正确个数|错误个数|正确率|
|----|------|--------|------|
|1|1622|1876|86.62%|
|2|3261|3759|86.75%|
|3|4553|10042|45.34%|
可以看出,当训练集和测试集的中各类的比例相似时,分类的效率还是较高的,但是当使用随机的比例时,分类的效率很低

接下来的测试中,使用了伯努利模型对文档分类
|模型|分类|正确个数|错误个数|正确率|
|----|----|------|--------|------|
|伯努利模型|1|102|1876|5.44%|
|伯努利模型|2|198|3759|5.27%|
|伯努利模型|3|981|7846|12.5%|

根据运行效果可知,伯努利模型的效果和多项式模型的分类结果相比要差不少.

## 总结

在该实验中,我使用了朴素贝叶斯方法对数据集进行了分类,其中,分别采用了多项式模型,伯努利模型分别讨论了分类的效果,了解了朴素贝叶斯的思想和在实现的过程中使用的一些技巧